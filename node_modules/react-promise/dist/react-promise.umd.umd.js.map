{"version":3,"file":"react-promise.umd.umd.js","sources":["../src/react-promise.js"],"sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\n\nconst statusTypes = {\n  none: 'none',\n  pending: 'pending',\n  rejected: 'rejected',\n  resolved: 'resolved'\n}\n\nexport class Async extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      status: statusTypes.none\n    }\n  }\n  componentWillReceiveProps(nP) {\n    if (nP.promise !== this.props.promise) {\n      this.setState({\n        status: statusTypes.none\n      })\n      this.handlePromise(nP.promise)\n    }\n  }\n  handlePromise(prom) {\n    this.promise = prom\n    this.setState({\n      status: statusTypes.pending\n    })\n    prom.then(\n      res => {\n        if (this.promise !== prom) {\n          return // this promise has been switched for some other before it resolved, so we can early return\n        }\n        if (!this.unmounted) {\n          this.setState({\n            status: statusTypes.resolved,\n            value: res\n          })\n        }\n      },\n      err => {\n        if (this.promise !== prom) {\n          return // this promise has been switched for some other before it rejected, so we can early return\n        }\n        if (!this.unmounted) {\n          this.setState({\n            status: statusTypes.rejected,\n            value: err\n          })\n        }\n      }\n    )\n  }\n  componentWillMount() {\n    if (this.props.promise) {\n      this.handlePromise(this.props.promise)\n    }\n  }\n  componentWillUnmount() {\n    this.unmounted = true\n  }\n\n  render() {\n    const { props, state } = this\n\n    switch (state.status) {\n      case statusTypes.none:\n        if (props.before) {\n          return props.before(this.handlePromise.bind(this))\n        }\n        break\n      case statusTypes.pending:\n        if (props.pending) {\n          if (typeof props.pending === 'function') {\n            return props.pending()\n          } else {\n            return props.pending\n          }\n        } else if (Async.defaultPending) {\n          if (typeof Async.defaultPending === 'function') {\n            return Async.defaultPending()\n          } else {\n            return Async.defaultPending\n          }\n        }\n        break\n      case statusTypes.resolved:\n        if (props.then) {\n          return props.then(state.value)\n        }\n        break\n      case statusTypes.rejected:\n        if (props.catch) {\n          return props.catch(state.value)\n        }\n        break\n    }\n\n    return null\n  }\n}\n\nAsync.propTypes = {\n  before: PropTypes.func, // renders it's return value before promise is handled\n  then: PropTypes.func, // renders it's return value when promise is resolved\n  catch: PropTypes.func, // renders it's return value when promise is rejected\n  pending: PropTypes.oneOfType([PropTypes.node, PropTypes.func]), // renders it's value when promise is pending\n  promise: PropTypes.object // promise itself\n}\n\n// Ensures named exports compatibility with the CommonJS-style `module.exports = Async;`\nAsync.Async = Async\n\nexport default Async\n"],"names":["const","statusTypes","none","pending","rejected","resolved","Async","constructor","props","state","status","componentWillReceiveProps","nP","promise","this","setState","handlePromise","prom","then","res","unmounted","value","err","componentWillMount","componentWillUnmount","render","before","bind","defaultPending","catch","React","Component","propTypes","PropTypes","func","oneOfType","node","object"],"mappings":"gWAGAA,IAAMC,EAAc,CAClBC,KAAM,OACNC,QAAS,UACTC,SAAU,WACVC,SAAU,YAGCC,cACXC,WAAYC,eACJA,QACDC,MAAQ,CACXC,OAAQT,EAAYC,sGAGxBS,mCAA0BC,GACpBA,EAAGC,UAAYC,KAAKN,MAAMK,eACvBE,SAAS,CACZL,OAAQT,EAAYC,YAEjBc,cAAcJ,EAAGC,uBAG1BG,uBAAcC,mBACPJ,QAAUI,OACVF,SAAS,CACZL,OAAQT,EAAYE,UAEtBc,EAAKC,cACHC,GACML,EAAKD,UAAYI,IAGhBH,EAAKM,aACHL,SAAS,CACZL,OAAQT,EAAYI,SACpBgB,MAAOF,eAIbG,GACMR,EAAKD,UAAYI,IAGhBH,EAAKM,aACHL,SAAS,CACZL,OAAQT,EAAYG,SACpBiB,MAAOC,oBAMjBC,8BACMT,KAAKN,MAAMK,cACRG,cAAcF,KAAKN,MAAMK,sBAGlCW,qCACOJ,WAAY,eAGnBK,wBAC2BX,aAAAA,kBAEjBL,EAAMC,aACPT,EAAYC,QACXM,EAAMkB,cACDlB,EAAMkB,OAAOZ,KAAKE,cAAcW,KAAKb,kBAG3Cb,EAAYE,WACXK,EAAML,cACqB,mBAAlBK,EAAML,QACRK,EAAML,UAENK,EAAML,QAEV,GAAIG,EAAMsB,qBACqB,mBAAzBtB,EAAMsB,eACRtB,EAAMsB,iBAENtB,EAAMsB,0BAId3B,EAAYI,YACXG,EAAMU,YACDV,EAAMU,KAAKT,EAAMY,kBAGvBpB,EAAYG,YACXI,EAAMqB,aACDrB,EAAMqB,MAAMpB,EAAMY,cAKxB,SA1FgBS,EAAMC,WA8FjCzB,EAAM0B,UAAY,CAChBN,OAAQO,EAAUC,KAClBhB,KAAMe,EAAUC,KAChBL,MAAOI,EAAUC,KACjB/B,QAAS8B,EAAUE,UAAU,CAACF,EAAUG,KAAMH,EAAUC,OACxDrB,QAASoB,EAAUI,QAIrB/B,EAAMA,MAAQA"}